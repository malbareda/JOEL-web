{%  load staticfiles %}{%  load markdown %}{%  load mptt_tags %}{%  load gravatar %}{%  load i18n %}{%  load tz %}{%  load rating %}{%  load reference %}
<div id="comments" class="comment-area">
  <h2><i style="padding-right: 0.3em" class="fa fa-comments"></i>{% trans "Comments" %}
  </h2>
{% if  has_comments %}
  <ul class="comments top-level-comments new-comments">{% set logged_in = request.user.is_authenticated %}{% if  logged_in %}{% set profile = request.user.profile %}{% endif %}{%  recursetree comment_list %}{% if  not node.hidden %}
    <li id="comment-{{ node.id }}"{{__pyjade_attrs(attrs=[('data-revision',(node.revisions - 1)), ('data-max-revision',(node.revisions - 1))])}} data-revision-ajax="{% url "comment_revision_ajax" node.id %}" class="comment">
      <div class="comment-display">
        <div class="info">
          <div class="vote">{% if  request.user.is_authenticated %}<a href="javascript:comment_upvote({{ node.id }})"{{__pyjade_attrs(attrs=[('class', (("upvote-link") , ("fa") , ("fa-chevron-up") , ("fa-fw") , (('voted' if node.vote_score == 1 else ''))))])}}></a>{% else %}<a href="javascript:void(0)" title="{% trans "Please login to vote" %}" class="upvote-link fa fa-chevron-up fa-fw"></a>{% endif %}<br/>
            <div class="comment-score">{{node.score|escape}}</div>{% if  request.user.is_authenticated %}<a href="javascript:comment_downvote({{ node.id }})"{{__pyjade_attrs(attrs=[('class', (("downvote-link") , ("fa") , ("fa-chevron-down") , ("fa-fw") , (('voted' if node.vote_score == -1 else ''))))])}}></a>{% else %}<a href="javascript:void(0)" title="{% trans "Please login to vote" %}" class="downvote-link fa fa-chevron-down fa-fw"></a>{% endif %}
          </div><a href="{% url "user_page" node.author.user.username %}" class="user"><img src="{% gravatar_url node.author.user.email 135 node.author.mute %}" class="gravatar"/></a>
        </div>
        <div class="detail">
          <div class="header"><a href="{% url "user_page" node.author.user.username %}" class="username rating {{ node.author.rating|rating_class }} {{node.author.display_rank}}">{{node.author.user.username|escape}}</a>
            <div class="relative-time"></div><span data-unix="{{ node.time|utc|date:"c" }}" class="comment-time">&nbsp;{% trans "commented" %}
{%  blocktrans with time=node.time|date:_("N j, Y") asvar str_time %}on {{ time }}<span class="relative">{{str_time|escape}}</span></span><span class="comment-spacer"></span><span class="comment-operation">{% if  node.revisions > 1 %}<span class="comment-edits"><a href="javascript:show_revision({{ node.id }}, -1)" class="previous-revision">&larr;</a><span class="comment-edit-text">{% if  node.revisions > 2 %}{{' '|escape}}{% set edits = node.revisions - 1 %}{%  blocktrans %}edit {{ edits }}
{{' '|escape}}{% else %}{{' '|escape}}{% trans "edited" %}{% endif %}</span><a href="javascript:show_revision({{ node.id }}, 1)" style="visibility: hidden" class="next-revision">&rarr;</a></span>{% else %}<span class="comment-edits"></span>{% endif %}<a href="#comment-{{ node.id }}" title="{% trans "Link" %}" class="comment-link"><i class="fa fa-link fa-fw"></i></a>{% if  logged_in %}{% set can_edit = node.author.id == profile.id and not profile.mute %}{% if  can_edit %}<a data-featherlight="{% url "comment_edit_ajax" node.id %}" href="{% url "comment_edit" node.id %}" title="{% trans "Edit" %}" class="edit-link"><i class="fa fa-pencil fa-fw"></i></a>{% else %}<a href="javascript:comment_set_parent({{ node.id }})" title="{% trans "Reply" %}"><i class="fa fa-reply fa-fw"></i></a>{% endif %}{% if  perms.judge.change_comment %}{% if  can_edit %}<a href="javascript:comment_set_parent({{ node.id }})" title="{% trans "Reply" %}"><i class="fa fa-reply fa-fw"></i></a>{% else %}<a data-featherlight="{% url "comment_edit_ajax" node.id %}" href="{% url "comment_edit" node.id %}" title="{% trans "Edit" %}" class="edit-link"><i class="fa fa-pencil fa-fw"></i></a>{% endif %}<a href="javascript:;" title="{% trans "Hide" %}"{{__pyjade_attrs(attrs=[('data-id',(node.id))])}} class="hide-comment"><i class="fa fa-trash fa-fw"></i></a><a href="{% url "admin:judge_comment_change" node.id %}" title="{% trans "Admin" %}"><i class="fa fa-cog fa-fw"></i></a>{% endif %}{% endif %}</span>
          </div>
          <div class="content content-description">
            <div{{__pyjade_attrs(attrs=[('style',(('display: none' if not node.title or node.title.startswith('Re:') else '')))])}} class="comment-title">{{node.title|escape}}</div>
            <div class="comment-body">{{node.body|with_math:MATH_ENGINE|with_lazy_load:True|markdown:"comment"|reference|escape}}</div>
          </div>
        </div>
      </div>
    </li>{% if  not node.is_leaf_node %}
    <ul class="comments">{{ children }}
    </ul>{% endif %}{% endif %}
{%  endrecursetree %}
  </ul>{% else %}
  <p class="no-comments-message">{% trans "There are no comments at the moment." %}</p>{% endif %}{% if  request.user.is_authenticated and comment_form %}
  <div class="form-area comment-submit">{% block comment_submit_title %}
    <h3>{% trans "New comment" %}</h3>
    <hr/>{% endblock %}{% if  is_new_user %}
    <div style="margin-bottom: 0" class="alert alert-info">{%  trans "You need to have solved at least one problem before your voice can be heard." %}
    </div>{% else %}
    <form id="comment-submit" action="" method="post">{%  csrf_token %}{% if  comment_form.errors %}
      <div id="form-errors">{{comment_form.non_field_errors|escape}}
{{comment_form.parent.errors|escape}}
{% if  comment_form.body.errors %}{% trans "Invalid comment body." %}{% endif %}
      </div>{% endif %}
{{comment_form.parent|escape}}
      <div class="comment-post-wrapper">
        <div id="comment-form-body">{{comment_form.body|escape}}
        </div>
      </div>
      <hr/>
      <input style="float:right" type="submit" value="{% trans "Post!" %}" class="button"/>
    </form>{% endif %}
  </div>{% endif %}
</div>