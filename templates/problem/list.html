{% extends "common-content.jade" %}{%  load staticfiles %}{%  load cache %}{%  load i18n %}{%  load json %}{%  load compress %}{% block media %}
<link rel="stylesheet" href="{% static "libs/nouislider.min.css" %}"/>
<style>@media (max-width: 550px) {
    #problem-table tr :nth-child(6) {
        display: none;
    }
}

@media (max-width: 450px) {
    #problem-table tr :nth-child(4) {
        display: none;
    }
}

@media (max-width: 350px) {
    #problem-table tr :nth-child(3) {
        display: none;
    }
}

#problem-table th a {
    color: inherit;
    display: block;
    padding: 4px 10px;
}

#category, #types {
    visibility: hidden;
}

.form-label {
    margin-top: 0.5em;
    font-style: italic;
}

#point-slider {
    margin: 30px 15px 10px;
}

#point-slider {
    height: 10px;
}

#point-slider .noUi-handle {
    height: 20px;
    width: 16px;
    left: -8px;
}

#point-slider .noUi-handle:before, #point-slider .noUi-handle:after {
    top: 3px;
    height: 12px;
}

#point-slider .noUi-handle:before {
    left: 5px;
}

#point-slider .noUi-handle:after {
    left: 8px;
}

#point-slider .noUi-tooltip {
    height: 17px;
    line-height: 13px;
    padding: 0 3px;
    font-size: 13px;
}
</style>
<noscript>
  <style>#category, #types {
    visibility: visible;
}
  </style>
</noscript>
{% if  not IN_CONTEST %}
<style>#problem-table th { padding: 0; }

a.hot-problem-link:hover > .hot-problem-count {
    visibility: visible;
}

span.hot-problem-count {
    color: #555;
    font-size: 0.75em;
    vertical-align: super;
    visibility: hidden;
    padding-left: 0.25em;
    position: relative;
}

.blog-content.sidebox {
    margin-right: 1em;
}

ul.problem-list {
    padding: 0 !important;
}
</style>{% endif %}{% endblock %}
{% block js_media %}
<script>window.point_start = {{point_start|escape}};
window.point_end = {{point_end|escape}};
window.point_values = {{point_values|json|safe|escape}};
</script>
{%  compress js %}
<script src="{% static "libs/nouislider.min.js" %}" type="text/javascript"></script>
<script>$(function() {
    var $form = $('form#filter-form');
    var $search = $('#search');
    var $category = $('#category');

    function clean_submit() {
        $search.prop('disabled', !$search.val());
        $category.prop('disabled', !$category.val());
        $form.submit();
    }

    $category.select2().css({'visibility': 'visible'}).change(clean_submit);
    $('#types').select2({multiple: 1, placeholder: '{% trans "Filter by type..." %}'})
        .css({'visibility': 'visible'});

    // This is incredibly nasty to do but it's needed because otherwise the select2 steals the focus
    $search.keypress(function (e) {
        if (e.keyCode == 13)
            $('#go').click();
    });

    $('#random').click(function (e) {
        var action = $form.attr('action');
        $form.attr('action', '{% url "problem_random" %}').attr('target', '_blank').submit();
        $form.attr('action', action).attr('target', '');
        e.preventDefault();
    });

    $('#go').click(clean_submit);

    $('input#full_text, input#hide_solved, input#show_types').click(function () {
        ($('<form>').attr('action', window.location.pathname + '?' + $('form#filter-form').serialize())
                .append($('<input>').attr('type', 'hidden').attr('name', 'csrfmiddlewaretoken')
                        .attr('value', $.cookie('csrftoken')))
                .attr('method', 'POST').appendTo($('body')).submit());
    });

    var info_float = $('.info-float');
    var container = $('#content-right');
    if (window.bad_browser) {
        container.css('float', 'right');
    } else if (!featureTest('position', 'sticky')) {
        fix_div(info_float, 55);
        $(window).resize(function () {
            info_float.width(container.width());
        });
        info_float.width(container.width());
    }

    var intFormatter = {
        to: function (value) {
            return value;
        },
        from: function (value) {
            return +value;
        }
    };
    var $slider = $('#point-slider');
    if ($slider.length) {
        var $start = $('#point-start');
        var $end = $('#point-end');

        noUiSlider.create($slider[0], {
            start: [point_start, point_end],
            connect: true,
            snap: true,
            tooltips: [intFormatter, intFormatter],
            range: point_values
        }).on('change', function (values) {
            var start = +values[0], end = +values[1];
            $start.prop('disabled', start === point_values.min).val(start);
            $end.prop('disabled', end === point_values.max).val(end);
        });
    }
});
</script>{% endcompress %}
{% if  IN_CONTEST %}{%  compress js %}
<script src="{% static "libs/tablesorter.js" %}" type="text/javascript"></script>
<script type="text/javascript">$(function() {
    $.tablesorter.addParser({
        id: 'solvedsort',
        is: function (s) {
            return false;
        },
        format: function (s, table, cell, cellIndex) {
            return $(cell).attr('solved');
        },
        type: 'numeric'
    });

    $('#problem-table').tablesorter({
        headers: {
            0: {
                sorter: 'solvedsort'
            }
        },
        textExtraction: function (node) {
            node = $(node);
            var text = node.text().replace(/^\s+|\s+$/g, '');
            return (node.hasClass('p') ? text.replace(/p$/, '') : text);
        }
    });
});
</script>{% endcompress %}{% endif %}{% endblock %}
{% block title_ruler %}{% endblock %}{% block title_row %}{% set tab = 'list' %}{% set title = 'Problems' %}{% include "problem/problem-list-tabs.jade" %}{% endblock %}{% block body %}
<div id="common-content">{% block before_table %}{% endblock %}{% if  not IN_CONTEST %}
  <div id="content-right" class="problems">
    <div class="info-float">{% include "problem/search-form.jade" %}{% if  hot_problems %}
      <div class="sidebox">
        <h3>{% trans "Hot problems" %} <i class="fa fa-fire"></i>
        </h3>
        <div class="sidebox-content">
          <ul class="problem-list">{% for problem in __pyjade_iter(hot_problems,1) %}
            <li><a href="{% url "problem_detail" problem.code %}" class="hot-problem-link">{{problem.name|escape}}<span class="hot-problem-count">{{problem.count|escape}}</span></a>
            </li>{% endfor %}
          </ul>
        </div>
      </div>{% endif %}
    </div>
  </div>{% endif %}
  <div id="content-left" class="problems">{% if  page_obj.num_pages > 1 %}
    <div style="margin-bottom: 7px; margin-top: 3px;">{% include "list-pages.jade" %}
    </div>{% endif %}
    <table id="problem-table" class="table striped">
      <thead>
        <tr>{% if  IN_CONTEST %}{% if  request.user.is_authenticated %}
          <th class="solved"><i class="fa fa-check"></i>
          </th>{% endif %}
          <th class="problem">{% trans "Problem" %}</th>
          <th class="category">{% trans "Category" %}</th>{% if  show_types %}
          <th>{% trans "Types" %}</th>{% endif %}
          <th class="points">{% trans "Points" %}</th>
          <th class="users">{% trans "Users" %}</th>{% else %}{% if  request.user.is_authenticated %}
          <th class="solved"><a{{__pyjade_attrs(attrs=[('href',(sort_links['solved']))])}}><i class="fa fa-check"></i>{{sort_order.solved|escape}}</a>
          </th>{% endif %}
          <th class="problem"><a{{__pyjade_attrs(attrs=[('href',(sort_links['name']))])}}>{% trans "Problem" %}{{sort_order.name|escape}}</a>
          </th>
          <th class="category"><a{{__pyjade_attrs(attrs=[('href',(sort_links['group']))])}}>{% trans "Category" %}{{sort_order.group|escape}}</a>
          </th>{% if  show_types %}
          <th><a{{__pyjade_attrs(attrs=[('href',(sort_links['type']))])}}>{% trans "Types" %}{{sort_order.type|escape}}</a>
          </th>{% endif %}
          <th class="points"><a{{__pyjade_attrs(attrs=[('href',(sort_links['points']))])}}>{% trans "Points" %}{{sort_order.points|escape}}</a>
          </th>
          <th class="ac-rate"><a{{__pyjade_attrs(attrs=[('href',(sort_links['ac_rate']))])}}>{% trans "AC %" %}{{sort_order.ac_rate|escape}}</a>
          </th>
          <th class="users"><a{{__pyjade_attrs(attrs=[('href',(sort_links['user_count']))])}}>{% trans "Users" %}{{sort_order.user_count|escape}}</a>
          </th>{% endif %}
        </tr>
      </thead>
      <tbody>{% for problem in __pyjade_iter(problems,1) %}
        <tr>{% if  request.user.is_authenticated %}{% if  problem.id in completed_problem_ids %}
          <td solved="1"><a href="{% url "user_submissions" problem.code request.user.username %}">{% if  problem.is_public or IN_CONTEST %}<i class="solved-problem-color fa fa-check-circle"></i>{% else %}<i class="solved-problem-color fa fa-lock"></i>{% endif %}</a>
          </td>{% else %}{% if  problem.id in attempted_problems %}
          <td solved="0"><a href="{% url "user_submissions" problem.code request.user.username %}">{% if  problem.is_public or IN_CONTEST %}<i class="attempted-problem-color fa fa-minus-circle"></i>{% else %}<i class="attempted-problem-color fa fa-lock"></i>{% endif %}</a>
          </td>{% else %}
          <td solved="-1">{% if  problem.is_public or IN_CONTEST %}<i class="unsolved-problem-color fa fa-minus-circle"></i>{% else %}<i class="unsolved-problem-color fa fa-lock"></i>{% endif %}
          </td>{% endif %}{% endif %}{% endif %}
          <td class="problem"><a href="{% url "problem_detail" problem.code %}">{{problem.i18n_name|escape}}</a>
          </td>
          <td class="category">{{problem.group.full_name|escape}}</td>{% if  show_types %}
          <td class="types">{% for type in __pyjade_iter(problem.types_list,1) %}<span class="type-tag">{{type|escape}}</span>{% if  not forloop.last %}{{', '|escape}}{% endif %}{% endfor %}
          </td>{% endif %}
          <td class="p">{{problem.points|floatformat|escape}}{% if  problem.partial %}p{% endif %}
          </td>
{% if  not IN_CONTEST %}
          <td class="ac-rate">{{problem.ac_rate|floatformat:"1"|escape}}%</td>{% endif %}
          <td class="users"><a href="{% url "ranked_submissions" problem.code %}">{{problem.user_count|escape}}</a>
          </td>
        </tr>{% endfor %}
      </tbody>
    </table>{% if  page_obj.num_pages > 1 %}
    <div style="margin-top:10px;">{% include "list-pages.jade" %}
    </div>{% endif %}
  </div>
</div><br/>{% endblock %}